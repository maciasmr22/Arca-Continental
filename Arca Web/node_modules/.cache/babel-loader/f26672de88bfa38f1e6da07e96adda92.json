{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar LoggingService_1 = require(\"./LoggingService\");\n\nvar UnityLoaderService =\n/** @class */\nfunction () {\n  function UnityLoaderService() {\n    /**\n     * Reference to the document head.\n     * @type {HTMLHeadElement}\n     * @private\n     */\n    this.documentHead = document.getElementsByTagName(\"head\")[0];\n  }\n  /**\n   * Appends the Unity loader script to the window. When it's loaded a callback will\n   * be triggered. NOTE: This can't be a promisse due to JavaScript compatibilty.\n   * @param {string} source the path to the Unity loader file\n   * @param {Function} onLoad when the script is loaded\n   * @public\n   */\n\n\n  UnityLoaderService.prototype.append = function (source, onLoad) {\n    var _this = this;\n\n    if (typeof this.unityLoaderScript !== \"undefined\") if (source === this.unityLoaderScript.src) {\n      return onLoad();\n    } else {\n      this.unityLoaderScript.remove();\n    }\n    window.fetch(source).then(function (_response) {\n      if (_response.status >= 400) return LoggingService_1.loggingService.errorUnityLoaderNotFound(_response.status);\n\n      _response.text().then(function (_text) {\n        if (_text.trim().charAt(0) === \"<\") return LoggingService_1.loggingService.errorUnityLoaderNotFound(\"error doc\");\n        _this.unityLoaderScript = document.createElement(\"script\");\n        _this.unityLoaderScript.type = \"text/javascript\";\n        _this.unityLoaderScript.async = true;\n        _this.unityLoaderScript.src = source;\n\n        _this.unityLoaderScript.onload = function () {\n          if (typeof window.UnityLoader === \"undefined\") return LoggingService_1.loggingService.errorUnityLoaderNotFound();\n          onLoad();\n        };\n\n        _this.documentHead.appendChild(_this.unityLoaderScript);\n      }).catch(function (_reason) {\n        return LoggingService_1.loggingService.errorUnityLoaderNotFound(_reason);\n      });\n    }).catch(function (_reason) {\n      return LoggingService_1.loggingService.errorUnityLoaderNotFound(_reason);\n    });\n  };\n\n  return UnityLoaderService;\n}();\n\nexports.default = UnityLoaderService;","map":{"version":3,"mappings":";;;;;;AAAA;;AAEA;AAAA;AAAA;AAAA;AACE;;;;;AAKQ,wBAAgCA,QAAQ,CAACC,oBAAT,CACtC,MADsC,EAEtC,CAFsC,CAAhC;AAkDT;AAvCC;;;;;;;;;AAOOC,wCAAP,UAAcC,MAAd,EAA8BC,MAA9B,EAA8C;AAA9C;;AACE,QAAI,OAAO,KAAKC,iBAAZ,KAAkC,WAAtC,EACE,IAAIF,MAAM,KAAK,KAAKE,iBAAL,CAAuBC,GAAtC,EAA2C;AACzC,aAAOF,MAAM,EAAb;AACD,KAFD,MAEO;AACL,WAAKC,iBAAL,CAAuBE,MAAvB;AACD;AACHC,UAAM,CACHC,KADH,CACSN,MADT,EAEGO,IAFH,CAEQ,qBAAS;AACb,UAAIC,SAAS,CAACC,MAAV,IAAoB,GAAxB,EACE,OAAOC,gCAAeC,wBAAf,CAAwCH,SAAS,CAACC,MAAlD,CAAP;;AACFD,eAAS,CACNI,IADH,GAEGL,IAFH,CAEQ,iBAAK;AACT,YAAIM,KAAK,CAACC,IAAN,GAAaC,MAAb,CAAoB,CAApB,MAA2B,GAA/B,EACE,OAAOL,gCAAeC,wBAAf,CAAwC,WAAxC,CAAP;AACFK,aAAI,CAACd,iBAAL,GAAyBL,QAAQ,CAACoB,aAAT,CAAuB,QAAvB,CAAzB;AACAD,aAAI,CAACd,iBAAL,CAAuBgB,IAAvB,GAA8B,iBAA9B;AACAF,aAAI,CAACd,iBAAL,CAAuBiB,KAAvB,GAA+B,IAA/B;AACAH,aAAI,CAACd,iBAAL,CAAuBC,GAAvB,GAA6BH,MAA7B;;AACAgB,aAAI,CAACd,iBAAL,CAAuBkB,MAAvB,GAAgC;AAC9B,cAAI,OAAQf,MAAc,CAACgB,WAAvB,KAAuC,WAA3C,EACE,OAAOX,gCAAeC,wBAAf,EAAP;AACFV,gBAAM;AACP,SAJD;;AAKAe,aAAI,CAACM,YAAL,CAAkBC,WAAlB,CAA8BP,KAAI,CAACd,iBAAnC;AACD,OAfH,EAgBGsB,KAhBH,CAgBS,mBAAO;AAAI,+CAAeb,wBAAf,CAAwCc,OAAxC;AAAgD,OAhBpE;AAiBD,KAtBH,EAuBGD,KAvBH,CAuBS,mBAAO;AAAI,6CAAeb,wBAAf,CAAwCc,OAAxC;AAAgD,KAvBpE;AAwBD,GA/BM;;AAgCT;AAAC,CAxDD","names":["document","getElementsByTagName","UnityLoaderService","source","onLoad","unityLoaderScript","src","remove","window","fetch","then","_response","status","LoggingService_1","errorUnityLoaderNotFound","text","_text","trim","charAt","_this","createElement","type","async","onload","UnityLoader","documentHead","appendChild","catch","_reason"],"sources":["../../source/services/UnityLoaderService.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}